<?xml version="1.0" encoding="UTF-8"?>
<querylist>
	<query name="КОНЕЦПЕРИОДА(АВСреднийЗаработок">
		<text>ВЫБРАТЬ
	КОНЕЦПЕРИОДА(АВСреднийЗаработок.Период, МЕСЯЦ) КАК Период,
	СУММА(ВЫБОР
			КОГДА АВНачисленияСреднийЗаработок.ПрименятьКоэффициентПовышения = ИСТИНА
				ТОГДА АВСреднийЗаработок.СуммаЗаработка
			ИНАЧЕ 0
		КОНЕЦ) КАК ПовышаемаяСумма,
	СУММА(ВЫБОР
			КОГДА АВНачисленияСреднийЗаработок.ПрименятьКоэффициентПовышения = ЛОЖЬ
				ТОГДА АВСреднийЗаработок.СуммаЗаработка
			ИНАЧЕ 0
		КОНЕЦ) КАК НеПовышаемаяСумма,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ АВСреднийЗаработок.Разница 
					И АВСреднийЗаработок.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.АВВидыЗанятости.ОсновноеМестоРаботы)
					ИЛИ АВСреднийЗаработок.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.АВВидыЗанятости.Совместительство) 
				ТОГДА АВСреднийЗаработок.ОтработаноДней
			ИНАЧЕ 0
		КОНЕЦ) КАК ОтработаноДнейПоОсновномуМестуРаботы,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ АВСреднийЗаработок.Разница 
					И АВСреднийЗаработок.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.АВВидыЗанятости.ОсновноеМестоРаботы)
					ИЛИ АВСреднийЗаработок.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.АВВидыЗанятости.Совместительство) 
				ТОГДА АВСреднийЗаработок.ОтработаноЧасов
			ИНАЧЕ 0
		КОНЕЦ) КАК ОтработаноЧасовПоОсновномуМестуРаботы,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ АВСреднийЗаработок.Разница
					И НЕ АВСреднийЗаработок.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.АВВидыЗанятости.ОсновноеМестоРаботы)
					И НЕ АВСреднийЗаработок.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.АВВидыЗанятости.Совместительство)
				ТОГДА АВСреднийЗаработок.ОтработаноДней
			ИНАЧЕ 0
		КОНЕЦ) КАК ОтработаноДнейПрочиеРабочиеМеста,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ АВСреднийЗаработок.Разница
					И НЕ АВСреднийЗаработок.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.АВВидыЗанятости.ОсновноеМестоРаботы)
					И НЕ АВСреднийЗаработок.ВидЗанятости = ЗНАЧЕНИЕ(Перечисление.АВВидыЗанятости.Совместительство)
				ТОГДА АВСреднийЗаработок.ОтработаноЧасов
			ИНАЧЕ 0
		КОНЕЦ) КАК ОтработаноЧасовПрочиеРабочиеМеста,
	АВСреднийЗаработок.Работник КАК Работник,
	АВСреднийЗаработок.Должность КАК Должность,
	АВСреднийЗаработок.ВидЗанятости КАК ВидЗанятости,
	АВСреднийЗаработок.Регистратор КАК Регистратор,
	АВСреднийЗаработок.Подпрограмма КАК Подпрограмма
ПОМЕСТИТЬ ВТ_СреднийЗаработок
ИЗ
	РегистрСведений.АВСреднийЗаработок КАК АВСреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ ПланВидовРасчета.АВНачисления.СреднийЗаработок КАК АВНачисленияСреднийЗаработок
		ПО АВСреднийЗаработок.ВидРасчета = АВНачисленияСреднийЗаработок.ВидРасчета
ГДЕ
	АВНачисленияСреднийЗаработок.Ссылка = &amp;ВидРасчета
	И АВСреднийЗаработок.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
	И АВСреднийЗаработок.Работник = &amp;Работник
	И АВНачисленияСреднийЗаработок.Использовать

СГРУППИРОВАТЬ ПО
	КОНЕЦПЕРИОДА(АВСреднийЗаработок.Период, МЕСЯЦ),
	АВСреднийЗаработок.Должность,
	АВСреднийЗаработок.Регистратор,
	АВСреднийЗаработок.Работник,
	АВСреднийЗаработок.ВидЗанятости,
	АВСреднийЗаработок.Подпрограмма
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,7,31,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа1	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза1, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,7,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,7,31,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза1, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,7,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,7,31,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа1
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа1
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа1
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа1) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа1, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа1, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж1
ИЗ
	ВТ_ДатаНачалаСтажа1 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа1) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа1
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа1) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа1
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа1) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа1
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа1 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза1, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты1
ИЗ
	ВТ_Стаж1 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза1, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза1, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза1, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,8,31,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа2	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза2, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,8,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,8,31,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза2, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,8,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,8,31,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа2
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа2
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа2
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа2) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа2, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа2, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа2, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа2, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж2
ИЗ
	ВТ_ДатаНачалаСтажа2 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа2) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа2, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа2
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа2) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа2, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа2
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа2) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа2, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа2
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа2 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза2, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты2
ИЗ
	ВТ_Стаж2 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза2, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза2, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза2, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,9,30,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа3	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза3, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,9,30,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,9,30,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза3, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,9,30,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,9,30,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа3
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа3
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа3
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа3) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа3, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа3, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа3, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа3, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж3
ИЗ
	ВТ_ДатаНачалаСтажа3 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа3) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа3, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа3
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа3) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа3, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа3
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа3) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа3, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа3
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа3 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза3, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты3
ИЗ
	ВТ_Стаж3 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза3, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза3, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза3, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,10,31,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа4	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза4, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,10,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,10,31,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза4, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,10,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,10,31,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа4
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа4
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа4
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа4) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа4, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа4, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа4, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа4, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж4
ИЗ
	ВТ_ДатаНачалаСтажа4 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа4) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа4, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа4
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа4) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа4, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа4
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа4) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа4, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа4
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа4 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза4, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты4
ИЗ
	ВТ_Стаж4 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза4, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза4, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза4, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,11,30,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа5	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза5, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,11,30,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,11,30,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза5, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,11,30,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,11,30,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа5
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа5
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа5
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа5) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа5, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа5, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа5, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа5, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж5
ИЗ
	ВТ_ДатаНачалаСтажа5 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа5) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа5, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа5
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа5) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа5, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа5
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа5) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа5, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа5
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа5 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза5, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты5
ИЗ
	ВТ_Стаж5 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза5, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза5, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза5, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,12,31,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа6	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза6, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,12,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,12,31,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза6, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2022,12,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2022,12,31,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа6
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа6
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа6
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа6) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа6, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа6, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа6, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа6, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж6
ИЗ
	ВТ_ДатаНачалаСтажа6 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа6) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа6, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа6
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа6) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа6, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа6
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа6) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа6, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа6
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа6 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза6, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты6
ИЗ
	ВТ_Стаж6 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза6, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза6, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза6, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,1,31,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа7	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза7, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,1,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,1,31,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза7, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,1,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,1,31,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа7
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа7
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа7
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа7) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа7, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа7, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа7, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа7, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж7
ИЗ
	ВТ_ДатаНачалаСтажа7 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа7) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа7, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа7
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа7) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа7, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа7
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа7) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа7, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа7
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа7 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза7, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты7
ИЗ
	ВТ_Стаж7 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза7, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза7, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза7, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,2,28,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа8	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза8, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,2,28,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,2,28,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза8, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,2,28,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,2,28,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа8
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа8
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа8
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа8) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа8, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа8, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа8, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа8, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж8
ИЗ
	ВТ_ДатаНачалаСтажа8 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа8) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа8, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа8
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа8) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа8, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа8
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа8) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа8, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа8
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа8 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза8, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты8
ИЗ
	ВТ_Стаж8 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза8, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза8, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза8, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,3,31,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа9	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза9, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,3,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,3,31,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза9, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,3,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,3,31,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа9
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа9
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа9
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа9) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа9, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа9, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа9, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа9, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж9
ИЗ
	ВТ_ДатаНачалаСтажа9 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа9) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа9, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа9
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа9) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа9, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа9
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа9) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа9, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа9
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа9 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза9, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты9
ИЗ
	ВТ_Стаж9 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза9, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза9, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза9, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,4,30,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа10	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза10, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,4,30,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,4,30,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза10, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,4,30,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,4,30,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа10
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа10
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа10
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа10) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа10, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа10, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа10, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа10, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж10
ИЗ
	ВТ_ДатаНачалаСтажа10 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа10) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа10, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа10
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа10) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа10, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа10
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа10) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа10, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа10
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа10 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза10, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты10
ИЗ
	ВТ_Стаж10 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза10, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза10, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза10, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,5,31,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа11	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза11, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,5,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,5,31,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза11, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,5,31,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,5,31,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа11
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа11
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа11
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа11) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа11, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа11, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа11, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа11, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж11
ИЗ
	ВТ_ДатаНачалаСтажа11 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа11) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа11, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа11
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа11) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа11, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа11
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа11) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа11, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа11
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа11 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза11, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты11
ИЗ
	ВТ_Стаж11 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза11, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза11, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза11, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,6,30,23,59,59) КАК ПериодПоСреднему,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажа12	
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;НачалоПериодаСреза12, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,6,30,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,6,30,23,59,59),
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза12, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_СреднийЗаработок.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_СреднийЗаработок.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И ВТ_СреднийЗаработок.Период = ДАТАВРЕМЯ(2023,6,30,23,59,59)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_СреднийЗаработок.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;
////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДАТАВРЕМЯ(2023,6,30,23,59,59) КАК ПериодПоСреднему,
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа12
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа12
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа12
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа12) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа12, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа12, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа12, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа12, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_Стаж12
ИЗ
	ВТ_ДатаНачалаСтажа12 КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа12) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа12, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа12
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа12) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа12, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа12
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа12) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа12, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа12
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность,
			ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу
		ИЗ
			ВТ_ДатаНачалаСтажа12 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаСреза12, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период
					И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
			И ВТ_ДатаНачалаСтажа.ПриемНаРаботу = ВложенныйЗапрос.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_Стаж.Лет = 0
							ИЛИ ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_Стаж.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО КАК БДО,
	АВРегистрКоэффициентовКатегорийСрезПоследних.Категория.ФБШ КАК ФБШ,
	ВЫБОР
	КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.ПустаяСсылка)
		ТОГДА ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад)
		ИНАЧЕ ЕСТЬNULL(АВСостоянияПерсоналаСрезПоследних.ФормаОплаты, ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Оклад))
	КОНЕЦ КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_Коэффициенты12
ИЗ
	ВТ_Стаж12 КАК ВТ_Стаж
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;КонецПериодаСреза12, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО ВТ_Стаж.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;КонецПериодаСреза12, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;КонецПериодаСреза12, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО ВТ_Стаж.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
			И ВТ_Стаж.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
			И ВТ_Стаж.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу
;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Стаж.Работник КАК Работник,
	ВТ_Стаж.Должность КАК Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВТ_Стаж.Лет КАК Лет,
	ВТ_Стаж.Месяцев КАК Месяцев,
	ВТ_Стаж.Дней КАК Дней,
	ВТ_Стаж.Категория КАК Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней) КАК СтажЧислом,
	ВТ_Стаж.ПриемНаРаботу КАК ПриемНаРаботу
ПОМЕСТИТЬ ВТ_ГотовыйСтаж
ИЗ
	ВТ_Стаж1 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж2 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж3 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж4 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж5 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж6 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж7 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж8 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж9 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж10 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж11 КАК ВТ_Стаж
						
ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Стаж.ПериодПоСреднему,
	ВТ_Стаж.Работник,
	ВТ_Стаж.Должность,
	ВТ_Стаж.ДатаНачалаСтажаВГУ,
	ВТ_Стаж.СпособРасчетаСтажа,
	ВТ_Стаж.ПромежуточнаяДата,
	ВТ_Стаж.Лет,
	ВТ_Стаж.Месяцев,
	ВТ_Стаж.Дней,
	ВТ_Стаж.Категория,
	ВТ_Стаж.Лет * 365 + (ВТ_Стаж.Месяцев * 30 + ВТ_Стаж.Дней),
	ВТ_Стаж.ПриемНаРаботу
ИЗ
	ВТ_Стаж12 КАК ВТ_Стаж

;

////////////////////////////////////////////////////////////////////////////////

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент КАК Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней) КАК СтажЧислом,
	ВТ_Коэффициенты.БДО КАК БДО,
	ВТ_Коэффициенты.ФБШ КАК ФБШ,
	ВТ_Коэффициенты.ФормаОплаты КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_ГотовыеКоэффициенты
ИЗ
	ВТ_Коэффициенты1 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты2 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты3 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты4 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты5 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты6 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты7 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты8 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты9 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты10 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты11 КАК ВТ_Коэффициенты

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	ВТ_Коэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_Коэффициенты.Работник КАК Работник,
	ВТ_Коэффициенты.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_Коэффициенты.Должность КАК Должность,
	ВТ_Коэффициенты.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_Коэффициенты.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_Коэффициенты.Лет КАК Лет,
	ВТ_Коэффициенты.Месяцев КАК Месяцев,
	ВТ_Коэффициенты.Дней КАК Дней,
	ВТ_Коэффициенты.Коэффициент,
	ВТ_Коэффициенты.Лет * 365 + (ВТ_Коэффициенты.Месяцев * 30 + ВТ_Коэффициенты.Дней),
	ВТ_Коэффициенты.БДО,
	ВТ_Коэффициенты.ФБШ,
	ВТ_Коэффициенты.ФормаОплаты
ИЗ
	ВТ_Коэффициенты12 КАК ВТ_Коэффициенты

;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГотовыеКоэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_ГотовыеКоэффициенты.Работник КАК Работник,
	ВТ_ГотовыеКоэффициенты.Должность КАК Должность,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ ВТ_ГотовыеКоэффициенты.ФБШ
				ТОГДА ВТ_ГотовыеКоэффициенты.Коэффициент
			ИНАЧЕ 1
		КОНЕЦ) КАК Коэффициент,
	МАКСИМУМ(ВТ_ГотовыеКоэффициенты.СтажЧислом) КАК СтажЧислом,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ ВТ_ГотовыеКоэффициенты.ФБШ
					И НЕ ВТ_ГотовыеКоэффициенты.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
				ТОГДА ВТ_ГотовыеКоэффициенты.Коэффициент * ВТ_ГотовыеКоэффициенты.БДО
			ИНАЧЕ ВТ_ГотовыеКоэффициенты.Коэффициент
		КОНЕЦ) КАК Ставка,
	ВТ_ГотовыеКоэффициенты.ФормаОплаты КАК ФормаОплаты
ПОМЕСТИТЬ ВТ_КоэффициентыДляРазницы
ИЗ
	ВТ_ГотовыеКоэффициенты КАК ВТ_ГотовыеКоэффициенты

СГРУППИРОВАТЬ ПО
	ВТ_ГотовыеКоэффициенты.ПериодПоСреднему,
	ВТ_ГотовыеКоэффициенты.Работник,
	ВТ_ГотовыеКоэффициенты.Должность,
	ВТ_ГотовыеКоэффициенты.ФормаОплаты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГотовыйСтаж.Работник КАК Работник,
	АВДолжности.Ссылка КАК Должность,
	АВДолжности.Ссылка.ДолжностьДоФБШ КАК ДолжностьДоФБШ,
	АВДолжности.Ссылка.Категория КАК КатегорияФБШ
ПОМЕСТИТЬ ВТ_ДолжностиФБШ
ИЗ
	ВТ_ГотовыйСтаж КАК ВТ_ГотовыйСтаж
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.АВДолжности КАК АВДолжности
		ПО ВТ_ГотовыйСтаж.Должность = АВДолжности.ДолжностьДоФБШ
ГДЕ
	НЕ АВДолжности.Ссылка.ДолжностьДоФБШ = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)
	И НЕ АВДолжности.ПометкаУдаления

СГРУППИРОВАТЬ ПО
	ВТ_ГотовыйСтаж.Работник,
	АВДолжности.Ссылка,
	АВДолжности.Ссылка.ДолжностьДоФБШ,
	АВДолжности.Ссылка.Категория
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период) КАК Период,
	АВСтажРаботыВГУСрезПоследних.Работник КАК Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ) КАК ДатаНачалаСтажаВГУ,
	ВТ_ДолжностиФБШ.Должность КАК Должность,
	АВСтажРаботыВГУСрезПоследних.Лет КАК Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев КАК Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней КАК Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу КАК ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа КАК СпособРасчетаСтажа
ПОМЕСТИТЬ ВТ_ДатаНачалаСтажаПоПериодуРегистрации
ИЗ
	ВТ_ДолжностиФБШ КАК ВТ_ДолжностиФБШ
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;ПериодРегистрации, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО (ВТ_ДолжностиФБШ.Работник = АВСтажРаботыВГУСрезПоследних.Работник)
			И (ВТ_ДолжностиФБШ.Должность = АВСтажРаботыВГУСрезПоследних.Должность)
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_ДолжностиФБШ.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.Период),
	АВСтажРаботыВГУСрезПоследних.Работник,
	МАКСИМУМ(АВСтажРаботыВГУСрезПоследних.ДатаНачалаСтажаВГУ),
	ВТ_ДолжностиФБШ.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
ИЗ
	ВТ_ДолжностиФБШ КАК ВТ_ДолжностиФБШ
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаРегистрации, ) КАК АВСтажРаботыВГУСрезПоследних
		ПО ВТ_ДолжностиФБШ.Работник = АВСтажРаботыВГУСрезПоследних.Работник
			И ВТ_ДолжностиФБШ.Должность = АВСтажРаботыВГУСрезПоследних.Должность
ГДЕ
	НЕ АВСтажРаботыВГУСрезПоследних.Должность = ЗНАЧЕНИЕ(Справочник.АВДолжности.ПустаяСсылка)

СГРУППИРОВАТЬ ПО
	АВСтажРаботыВГУСрезПоследних.Работник,
	ВТ_ДолжностиФБШ.Должность,
	АВСтажРаботыВГУСрезПоследних.Лет,
	АВСтажРаботыВГУСрезПоследних.Месяцев,
	АВСтажРаботыВГУСрезПоследних.Дней,
	АВСтажРаботыВГУСрезПоследних.ПриемНаРаботу,
	АВСтажРаботыВГУСрезПоследних.СпособРасчетаСтажа
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ДатаНачалаСтажа.Работник КАК Работник,
	ВТ_ДатаНачалаСтажа.Должность КАК Должность,
	ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВложенныйЗапрос.ПромежуточнаяДата КАК ПромежуточнаяДата,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа1
						ТОГДА ВЫБОР
								КОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
									ТОГДА ГОД(ВложенныйЗапрос.ПромежуточнаяДата) - ГОД(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Лет
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа1
						ТОГДА ВЫБОР
								КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА 12 + МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА МЕСЯЦ(ВложенныйЗапрос.ПромежуточнаяДата) - МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Месяцев
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_ДатаНачалаСтажа.СпособРасчетаСтажа = ЗНАЧЕНИЕ(Перечисление.АВСпособыРасчетаСтажа.НеУчитыватьСтаж)
			ТОГДА ВЫБОР
					КОГДА ВТ_ДатаНачалаСтажа.Период &lt; &amp;ДатаСрезаСтажа1
						ТОГДА ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа1) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ВЫБОР
											КОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа1, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
												ТОГДА РАЗНОСТЬДАТ(ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1), &amp;ДатаСрезаСтажа1, ДЕНЬ) + ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
											ИНАЧЕ 0
										КОНЕЦ
								ИНАЧЕ ВЫБОР
										КОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ) &gt; 0
											ТОГДА ДЕНЬ(ВложенныйЗапрос.ПромежуточнаяДата) - ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
										ИНАЧЕ 0
									КОНЕЦ
							КОНЕЦ
					ИНАЧЕ ВТ_ДатаНачалаСтажа.Дней
				КОНЕЦ
		ИНАЧЕ 0
	КОНЕЦ КАК Дней,
	ВТ_ДатаНачалаСтажа.ПриемНаРаботу КАК ПриемНаРаботу,
	ВТ_ДатаНачалаСтажа.Должность.Категория КАК Категория
ПОМЕСТИТЬ ВТ_СтажПоПериодуРегистрации
ИЗ
	ВТ_ДатаНачалаСтажаПоПериодуРегистрации КАК ВТ_ДатаНачалаСтажа
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВЫБОР
				КОГДА МЕСЯЦ(ВЫБОР
							КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа1) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
								ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1)
							ИНАЧЕ &amp;ДатаСрезаСтажа1
						КОНЕЦ) &lt; МЕСЯЦ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
					ТОГДА ДОБАВИТЬКДАТЕ(ВЫБОР
								КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа1) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
									ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1)
								ИНАЧЕ &amp;ДатаСрезаСтажа1
							КОНЕЦ, МЕСЯЦ, -12)
				ИНАЧЕ ВЫБОР
						КОГДА ДЕНЬ(&amp;ДатаСрезаСтажа1) &lt; ДЕНЬ(ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ)
							ТОГДА ДОБАВИТЬКДАТЕ(&amp;ДатаСрезаСтажа1, МЕСЯЦ, -1)
						ИНАЧЕ &amp;ДатаСрезаСтажа1
					КОНЕЦ
			КОНЕЦ КАК ПромежуточнаяДата,
			ВТ_ДатаНачалаСтажа.Работник КАК Работник,
			ВТ_ДатаНачалаСтажа.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
			ВТ_ДатаНачалаСтажа.Должность КАК Должность
		ИЗ
			ВТ_ДатаНачалаСтажа1 КАК ВТ_ДатаНачалаСтажа
				ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСтажРаботыВГУ.СрезПоследних(&amp;КонецПериодаРегистрации, ) КАК АВСтажРаботыВГУСрезПоследних
				ПО ВТ_ДатаНачалаСтажа.Работник = АВСтажРаботыВГУСрезПоследних.Работник
					И ВТ_ДатаНачалаСтажа.Должность = АВСтажРаботыВГУСрезПоследних.Должность
					И ВТ_ДатаНачалаСтажа.Период = АВСтажРаботыВГУСрезПоследних.Период) КАК ВложенныйЗапрос
		ПО ВТ_ДатаНачалаСтажа.Работник = ВложенныйЗапрос.Работник
			И ВТ_ДатаНачалаСтажа.Должность = ВложенныйЗапрос.Должность
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГотовыйСтаж.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_ГотовыйСтаж.Работник КАК Работник,
	ВТ_ГотовыйСтаж.Должность КАК Должность,
	ВТ_ГотовыйСтаж.Категория КАК Категория,
	ВТ_СтажПоПериодуРегистрации.Должность КАК ДолжностьФБШ,
	ВТ_СтажПоПериодуРегистрации.Категория КАК КатегорияФБШ,
	ВЫБОР
		КОГДА НЕ ВТ_СтажПоПериодуРегистрации.Должность ЕСТЬ NULL
				ИЛИ ВТ_ГотовыйСтаж.Должность.Категория.ФБШ
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ФБШ,
	ВЫБОР
		КОГДА НЕ ВТ_СтажПоПериодуРегистрации.Должность ЕСТЬ NULL
			ТОГДА ВТ_СтажПоПериодуРегистрации.ДатаНачалаСтажаВГУ
		ИНАЧЕ ВТ_ГотовыйСтаж.ДатаНачалаСтажаВГУ
	КОНЕЦ КАК ДатаНачалаСтажаВГУ,
	ВЫБОР
		КОГДА НЕ ВТ_СтажПоПериодуРегистрации.Должность ЕСТЬ NULL
			ТОГДА ВТ_СтажПоПериодуРегистрации.СпособРасчетаСтажа
		ИНАЧЕ ВТ_ГотовыйСтаж.СпособРасчетаСтажа
	КОНЕЦ КАК СпособРасчетаСтажа,
	ВЫБОР
		КОГДА НЕ ВТ_СтажПоПериодуРегистрации.Должность ЕСТЬ NULL
			ТОГДА ВТ_СтажПоПериодуРегистрации.Лет
		ИНАЧЕ ВТ_ГотовыйСтаж.Лет
	КОНЕЦ КАК Лет,
	ВЫБОР
		КОГДА НЕ ВТ_СтажПоПериодуРегистрации.Должность ЕСТЬ NULL
			ТОГДА ВТ_СтажПоПериодуРегистрации.Месяцев
		ИНАЧЕ ВТ_ГотовыйСтаж.Месяцев
	КОНЕЦ КАК Месяцев,
	ВЫБОР
		КОГДА НЕ ВТ_СтажПоПериодуРегистрации.Должность ЕСТЬ NULL
			ТОГДА ВТ_СтажПоПериодуРегистрации.Дней
		ИНАЧЕ ВТ_ГотовыйСтаж.Дней
	КОНЕЦ КАК Дней,
	ВТ_ГотовыйСтаж.ПриемНаРаботу КАК ПриемНаРаботу
ПОМЕСТИТЬ ВТ_ГотовыйСтажСФБШ
ИЗ
	ВТ_ГотовыйСтаж КАК ВТ_ГотовыйСтаж
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СтажПоПериодуРегистрации КАК ВТ_СтажПоПериодуРегистрации
		ПО ВТ_ГотовыйСтаж.Должность = ВТ_СтажПоПериодуРегистрации.Должность.ДолжностьДоФБШ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ГотовыйСтажСФБШ.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_ГотовыйСтажСФБШ.Работник КАК Работник,
	ВТ_ГотовыйСтажСФБШ.Должность КАК Должность,
	ВТ_ГотовыйСтажСФБШ.ДолжностьФБШ КАК ДолжностьФБШ,
	ВТ_ГотовыйСтажСФБШ.ФБШ КАК ФБШ,
	ВТ_ГотовыйСтажСФБШ.ДатаНачалаСтажаВГУ КАК ДатаНачалаСтажаВГУ,
	ВТ_ГотовыйСтажСФБШ.СпособРасчетаСтажа КАК СпособРасчетаСтажа,
	ВТ_ГотовыйСтажСФБШ.Лет КАК Лет,
	ВТ_ГотовыйСтажСФБШ.Месяцев КАК Месяцев,
	ВТ_ГотовыйСтажСФБШ.Дней КАК Дней,
	ВЫБОР
		КОГДА АВСостоянияПерсоналаСрезПоследних.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению
		ИНАЧЕ ЕСТЬNULL(ВЫБОР
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет = 0
							ИЛИ ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон1
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле1
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон2
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле2
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон3
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле3
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон4
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле4
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон5
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле5
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон6
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле6
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон7
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле7
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон8
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле8
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон9
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле9
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон10
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле10
					КОГДА ВТ_ГотовыйСтажСФБШ.Лет &lt; АВСоответствиеКоэффициентовКатегорий.Диапазон11
						ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
					ИНАЧЕ АВРегистрКоэффициентовКатегорийСрезПоследних.Поле11
				КОНЕЦ, 0) * ВЫБОР
				КОГДА НЕ АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент = 0
					ТОГДА АВРегистрКоэффициентовКатегорийСрезПоследних.ПоправочныйКоэффициент
				ИНАЧЕ 1
			КОНЕЦ
	КОНЕЦ КАК Коэффициент,
	ВТ_ГотовыйСтажСФБШ.Лет * 365 + (ВТ_ГотовыйСтажСФБШ.Месяцев * 30 + ВТ_ГотовыйСтажСФБШ.Дней) КАК СтажЧислом,
	АВСостоянияПерсоналаСрезПоследних.ФормаОплаты КАК ФормаОплаты,
	АВСостоянияПерсоналаСрезПоследних.СтавкаПоСоглашению КАК СтавкаПоСоглашению
ПОМЕСТИТЬ ВТ_ПромежуточныеКоэффициенты
ИЗ
	ВТ_ГотовыйСтажСФБШ КАК ВТ_ГотовыйСтажСФБШ
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВРегистрКоэффициентовКатегорий.СрезПоследних(&amp;ПериодРегистрации, Учреждение = &amp;парамУчреждение) КАК АВРегистрКоэффициентовКатегорийСрезПоследних
			ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСоответствиеКоэффициентовКатегорий КАК АВСоответствиеКоэффициентовКатегорий
			ПО АВРегистрКоэффициентовКатегорийСрезПоследних.ГруппаКатегорий = АВСоответствиеКоэффициентовКатегорий.ГруппаКатегории
		ПО (ВЫБОР
				КОГДА ВТ_ГотовыйСтажСФБШ.ДолжностьФБШ ЕСТЬ NULL
					ТОГДА ВТ_ГотовыйСтажСФБШ.Категория = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
				ИНАЧЕ ВТ_ГотовыйСтажСФБШ.КатегорияФБШ = АВРегистрКоэффициентовКатегорийСрезПоследних.Категория
			КОНЕЦ)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВСостоянияПерсонала.СрезПоследних(&amp;ПериодРегистрации, Учреждение = &amp;парамУчреждение И СостояниеРаботника = ЗНАЧЕНИЕ(Перечисление.АВСостоянияПерсонала.Работает)) КАК АВСостоянияПерсоналаСрезПоследних
		ПО (ВТ_ГотовыйСтажСФБШ.Работник = АВСостоянияПерсоналаСрезПоследних.Работник
				И ВТ_ГотовыйСтажСФБШ.Должность = АВСостоянияПерсоналаСрезПоследних.Должность
				И ВТ_ГотовыйСтажСФБШ.ПриемНаРаботу = АВСостоянияПерсоналаСрезПоследних.ПриемНаРаботу)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_ПромежуточныеКоэффициенты.ПериодПоСреднему КАК ПериодПоСреднему,
	ВТ_ПромежуточныеКоэффициенты.Работник КАК Работник,
	ВТ_ПромежуточныеКоэффициенты.Должность КАК Должность,
	ВТ_ПромежуточныеКоэффициенты.ФБШ КАК ФБШ,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ ВТ_ПромежуточныеКоэффициенты.ФБШ
				ТОГДА ВТ_ПромежуточныеКоэффициенты.Коэффициент
			ИНАЧЕ 1
		КОНЕЦ) КАК Коэффициент,
	МАКСИМУМ(ВЫБОР
			КОГДА НЕ ВТ_ПромежуточныеКоэффициенты.ФБШ
					И НЕ ВТ_ПромежуточныеКоэффициенты.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
				ТОГДА ВТ_ПромежуточныеКоэффициенты.Коэффициент * АВМинимальныеРасчетныеПоказателиСрезПоследних.БДО
			ИНАЧЕ ВТ_ПромежуточныеКоэффициенты.Коэффициент
		КОНЕЦ) КАК Ставка,
	МАКСИМУМ(ВТ_ПромежуточныеКоэффициенты.СтажЧислом) КАК СтажЧислом,
	ВТ_ПромежуточныеКоэффициенты.Должность.ДолжностьДоФБШ КАК ДолжностьДоФБШ
ПОМЕСТИТЬ ВТ_НовыеКоэффициенты
ИЗ
	ВТ_ПромежуточныеКоэффициенты КАК ВТ_ПромежуточныеКоэффициенты
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АВМинимальныеРасчетныеПоказатели.СрезПоследних(&amp;ПериодРегистрации, Учреждение = &amp;парамУчреждение) КАК АВМинимальныеРасчетныеПоказателиСрезПоследних
		ПО (ИСТИНА)

СГРУППИРОВАТЬ ПО
	ВТ_ПромежуточныеКоэффициенты.ПериодПоСреднему,
	ВТ_ПромежуточныеКоэффициенты.Работник,
	ВТ_ПромежуточныеКоэффициенты.Должность,
	ВТ_ПромежуточныеКоэффициенты.ФБШ,
	ВТ_ПромежуточныеКоэффициенты.Должность.ДолжностьДоФБШ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_СреднийЗаработок.Период КАК Период,
	ВТ_СреднийЗаработок.Регистратор КАК Регистратор,
	СУММА(ВТ_СреднийЗаработок.ПовышаемаяСумма) КАК ПовышаемаяСумма,
	СУММА(ВТ_СреднийЗаработок.НеПовышаемаяСумма) КАК НеПовышаемаяСумма,
	ВТ_СреднийЗаработок.Должность КАК Должность,
	ВТ_СреднийЗаработок.ВидЗанятости КАК ВидЗанятости,
	ВТ_СреднийЗаработок.Подпрограмма КАК Подпрограмма,
	СУММА(ВТ_СреднийЗаработок.ОтработаноДнейПоОсновномуМестуРаботы) КАК ОтработаноДнейПоОсновномуМестуРаботы,
	СУММА(ВТ_СреднийЗаработок.ОтработаноЧасовПоОсновномуМестуРаботы) КАК ОтработаноЧасовПоОсновномуМестуРаботы,
	СУММА(ВТ_СреднийЗаработок.ОтработаноДнейПрочиеРабочиеМеста) КАК ОтработаноДнейПрочиеРабочиеМеста,
	СУММА(ВТ_СреднийЗаработок.ОтработаноЧасовПрочиеРабочиеМеста) КАК ОтработаноЧасовПрочиеРабочиеМеста,
	ВТ_КоэффициентыДляРазницы.Коэффициент КАК Коэффициент,
	ВТ_НовыеКоэффициенты.Коэффициент КАК НовыйКоэффициент,
	ВТ_КоэффициентыДляРазницы.Ставка КАК Ставка,
	ВТ_НовыеКоэффициенты.Ставка КАК НоваяСтавка,
	ВЫБОР
		КОГДА ВТ_КоэффициентыДляРазницы.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА ВЫБОР
					КОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1) &gt;= 1
						ТОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1)
					ИНАЧЕ 1
				КОНЕЦ
		ИНАЧЕ ВЫБОР
				КОГДА ВТ_НовыеКоэффициенты.ФБШ
					ТОГДА ВЫБОР
							КОГДА ВТ_СреднийЗаработок.Период &lt;= &amp;КонецПериодаДляРазницыФБШ
								ИЛИ НЕ ВТ_НовыеКоэффициенты.Должность.Категория.ФБШ
								ТОГДА ВЫБОР
										КОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1) &gt;= 1
											ТОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1)
										ИНАЧЕ 1
									КОНЕЦ
							ИНАЧЕ 1
						КОНЕЦ
				ИНАЧЕ ВЫБОР
						КОГДА ВТ_СреднийЗаработок.Период &lt;= &amp;КонецПериодаДляРазницы
							ТОГДА ВЫБОР
									КОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1) &gt;= 1
										ТОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1)
									ИНАЧЕ 1
								КОНЕЦ
						ИНАЧЕ 1
					КОНЕЦ
			КОНЕЦ
	КОНЕЦ КАК КоэффициентПовышения
ИЗ
	ВТ_СреднийЗаработок КАК ВТ_СреднийЗаработок
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_НовыеКоэффициенты КАК ВТ_НовыеКоэффициенты
		ПО (ВТ_СреднийЗаработок.Период = ВТ_НовыеКоэффициенты.ПериодПоСреднему)
			И (ВТ_СреднийЗаработок.Работник = ВТ_НовыеКоэффициенты.Работник)
			И (ВТ_СреднийЗаработок.Должность = ВТ_НовыеКоэффициенты.Должность)
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_КоэффициентыДляРазницы КАК ВТ_КоэффициентыДляРазницы
		ПО (ВТ_СреднийЗаработок.Период = ВТ_КоэффициентыДляРазницы.ПериодПоСреднему)
			И (ВТ_СреднийЗаработок.Работник = ВТ_КоэффициентыДляРазницы.Работник)
			И (ВТ_СреднийЗаработок.Должность = ВТ_КоэффициентыДляРазницы.Должность)

СГРУППИРОВАТЬ ПО
	ВТ_СреднийЗаработок.Период,
	ВТ_СреднийЗаработок.Регистратор,
	ВТ_СреднийЗаработок.Должность,
	ВТ_СреднийЗаработок.ВидЗанятости,
	ВТ_СреднийЗаработок.Подпрограмма,
	ВТ_НовыеКоэффициенты.Коэффициент,
	ВТ_КоэффициентыДляРазницы.Коэффициент,
	ВТ_КоэффициентыДляРазницы.Ставка,
	ВТ_НовыеКоэффициенты.Ставка,
	ВЫБОР
		КОГДА ВТ_КоэффициентыДляРазницы.ФормаОплаты = ЗНАЧЕНИЕ(Перечисление.АВФормаОплаты.Соглашение)
			ТОГДА ВЫБОР
					КОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1) &gt;= 1
						ТОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1)
					ИНАЧЕ 1
				КОНЕЦ
		ИНАЧЕ ВЫБОР
				КОГДА ВТ_НовыеКоэффициенты.ФБШ
					ТОГДА ВЫБОР
							КОГДА ВТ_СреднийЗаработок.Период &lt;= &amp;КонецПериодаДляРазницыФБШ 
								ИЛИ НЕ ВТ_НовыеКоэффициенты.Должность.Категория.ФБШ 
								ТОГДА ВЫБОР
										КОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1) &gt;= 1
											ТОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1)
										ИНАЧЕ 1
									КОНЕЦ
							ИНАЧЕ 1
						КОНЕЦ
				ИНАЧЕ ВЫБОР
						КОГДА ВТ_СреднийЗаработок.Период &lt;= &amp;КонецПериодаДляРазницы
							ТОГДА ВЫБОР
									КОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1) &gt;= 1
										ТОГДА ВТ_НовыеКоэффициенты.Ставка / ЕСТЬNULL(ВТ_КоэффициентыДляРазницы.Ставка, 1)
									ИНАЧЕ 1
								КОНЕЦ
						ИНАЧЕ 1
					КОНЕЦ
			КОНЕЦ
	КОНЕЦ

УПОРЯДОЧИТЬ ПО
	Период
ИТОГИ
	СУММА(ПовышаемаяСумма),
	СУММА(НеПовышаемаяСумма),
	СУММА(ОтработаноДнейПоОсновномуМестуРаботы),
	СУММА(ОтработаноЧасовПоОсновномуМестуРаботы),
	МАКСИМУМ(ОтработаноДнейПрочиеРабочиеМеста),
	МАКСИМУМ(ОтработаноЧасовПрочиеРабочиеМеста)
ПО
	Период,
	Регистратор
АВТОУПОРЯДОЧИВАНИЕ
</text>
		<parameters>
			<parameter name="ВидРасчета" type="ChartOfCalculationTypesRef.АВНачисления" value="fd57456c-563f-11e7-9002-3464a918ecee"/>
			<parameter name="ДатаСрезаСтажа1" type="Дата" value="2022-07-31T23:59:59"/>
			<parameter name="ДатаСрезаСтажа10" type="Дата" value="2023-04-30T23:59:59"/>
			<parameter name="ДатаСрезаСтажа11" type="Дата" value="2023-05-31T23:59:59"/>
			<parameter name="ДатаСрезаСтажа12" type="Дата" value="2023-06-30T23:59:59"/>
			<parameter name="ДатаСрезаСтажа2" type="Дата" value="2022-08-31T23:59:59"/>
			<parameter name="ДатаСрезаСтажа3" type="Дата" value="2022-09-30T23:59:59"/>
			<parameter name="ДатаСрезаСтажа4" type="Дата" value="2022-10-31T23:59:59"/>
			<parameter name="ДатаСрезаСтажа5" type="Дата" value="2022-11-30T23:59:59"/>
			<parameter name="ДатаСрезаСтажа6" type="Дата" value="2022-12-31T23:59:59"/>
			<parameter name="ДатаСрезаСтажа7" type="Дата" value="2023-01-31T23:59:59"/>
			<parameter name="ДатаСрезаСтажа8" type="Дата" value="2023-02-28T23:59:59"/>
			<parameter name="ДатаСрезаСтажа9" type="Дата" value="2023-03-31T23:59:59"/>
			<parameter name="КонецПериода" type="Дата" value="2023-06-30T23:59:59"/>
			<parameter name="КонецПериодаДляРазницы" type="Дата" value="2020-12-31T23:59:59"/>
			<parameter name="КонецПериодаДляРазницыФБШ" type="Дата" value="0001-01-01T00:00:00"/>
			<parameter name="КонецПериодаРегистрации" type="Дата" value="2023-07-31T23:59:59"/>
			<parameter name="КонецПериодаСреза1" type="Дата" value="2022-07-31T23:59:59"/>
			<parameter name="КонецПериодаСреза10" type="Дата" value="2023-04-30T23:59:59"/>
			<parameter name="КонецПериодаСреза11" type="Дата" value="2023-05-31T23:59:59"/>
			<parameter name="КонецПериодаСреза12" type="Дата" value="2023-06-30T23:59:59"/>
			<parameter name="КонецПериодаСреза2" type="Дата" value="2022-08-31T23:59:59"/>
			<parameter name="КонецПериодаСреза3" type="Дата" value="2022-09-30T23:59:59"/>
			<parameter name="КонецПериодаСреза4" type="Дата" value="2022-10-31T23:59:59"/>
			<parameter name="КонецПериодаСреза5" type="Дата" value="2022-11-30T23:59:59"/>
			<parameter name="КонецПериодаСреза6" type="Дата" value="2022-12-31T23:59:59"/>
			<parameter name="КонецПериодаСреза7" type="Дата" value="2023-01-31T23:59:59"/>
			<parameter name="КонецПериодаСреза8" type="Дата" value="2023-02-28T23:59:59"/>
			<parameter name="КонецПериодаСреза9" type="Дата" value="2023-03-31T23:59:59"/>
			<parameter name="НачалоПериода" type="Дата" value="2022-07-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза1" type="Дата" value="2022-07-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза10" type="Дата" value="2023-04-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза11" type="Дата" value="2023-05-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза12" type="Дата" value="2023-06-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза2" type="Дата" value="2022-08-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза3" type="Дата" value="2022-09-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза4" type="Дата" value="2022-10-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза5" type="Дата" value="2022-11-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза6" type="Дата" value="2022-12-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза7" type="Дата" value="2023-01-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза8" type="Дата" value="2023-02-01T00:00:00"/>
			<parameter name="НачалоПериодаСреза9" type="Дата" value="2023-03-01T00:00:00"/>
			<parameter name="парамУчреждение" type="CatalogRef.АВУчреждения" value="7c970fd7-563d-11e7-9002-3464a918ecee"/>
			<parameter name="ПериодРегистрации" type="Дата" value="2023-07-31T00:00:00"/>
			<parameter name="Работник" type="CatalogRef.АВПерсонал" value="c3d03e79-fe95-11e8-8083-3464a918ecee"/>
		</parameters>
	</query>
</querylist>